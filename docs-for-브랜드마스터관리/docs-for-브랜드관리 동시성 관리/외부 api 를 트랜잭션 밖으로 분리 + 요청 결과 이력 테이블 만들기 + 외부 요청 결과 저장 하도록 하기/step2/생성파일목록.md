# Step 2: 생성할 파일 목록

## 1. Flyway 마이그레이션

**경로**: `concurrency-lab/src/main/resources/db/migration/V7__create_brand_sync_history.sql`

```sql
-- 외부 API 동기화 이력 테이블
CREATE TABLE brand_sync_history (
    id                BIGSERIAL PRIMARY KEY,
    brand_id          BIGINT NOT NULL,
    brand_code        VARCHAR(50) NOT NULL,
    sync_type         VARCHAR(20) NOT NULL,
    sync_status       VARCHAR(20) NOT NULL DEFAULT 'PENDING',
    request_payload   TEXT,
    response_payload  TEXT,
    error_message     TEXT,
    retry_count       INT DEFAULT 0,
    created_at        TIMESTAMP DEFAULT NOW(),
    completed_at      TIMESTAMP,

    CONSTRAINT fk_brand_sync_history_brand
        FOREIGN KEY (brand_id) REFERENCES brand(id) ON DELETE CASCADE
);

CREATE INDEX idx_bsh_brand_id ON brand_sync_history(brand_id);
CREATE INDEX idx_bsh_status ON brand_sync_history(sync_status);
CREATE INDEX idx_bsh_created ON brand_sync_history(created_at);
```

## 2. 엔티티

**경로**: `concurrency-lab/src/main/java/com/opro/concurrency/entity/BrandSyncHistory.java`

## 3. 매퍼 인터페이스

**경로**: `concurrency-lab/src/main/java/com/opro/concurrency/mapper/BrandSyncHistoryMapper.java`

## 4. 매퍼 XML

**경로**: `concurrency-lab/src/main/resources/mapper/BrandSyncHistoryMapper.xml`
