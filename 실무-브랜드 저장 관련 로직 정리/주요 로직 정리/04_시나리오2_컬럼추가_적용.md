# 04. 시나리오2(컬럼 추가 방식) 연결 설명

참조 파일:
- doc/외부 api 호출과 디비 저장 프로세스/시나리오2 - 컬럼 추가 방식.md
- doc/외부 api 호출과 디비 저장 프로세스/시나리오2 - 컬럼 추가 방식.mmd
- doc/외부 api 호출과 디비 저장 프로세스/시나리오2 - 컬럼 추가 방식.txt

## 핵심 아이디어
- 기존 테이블에 연동 상태 컬럼을 추가하여
  DB 저장과 외부 반영 완료를 분리 관리

예시 컬럼:
- sync_status (PENDING,SUCCESS,FAILED)
- sync_retry_count
- last_sync_at
- last_sync_error_code
- last_sync_error_message

## 처리 흐름 권장
1. 트랜잭션 안에서는 내부 DB 저장 + sync_status=PENDING만 처리
2. 트랜잭션 커밋 이후 외부 API 호출(이벤트/비동기/후처리)
3. 성공 시 SUCCESS, 실패 시 FAILED와 오류 정보 업데이트
4. 스케줄러/관리자 기능으로 재시도

## 장점
- DB와 외부 상태를 가시화
- 실패 건 선별 재처리 가능
- 장애 시 운영 대응 용이
