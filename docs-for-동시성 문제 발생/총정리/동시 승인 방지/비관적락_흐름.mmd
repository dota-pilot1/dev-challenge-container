sequenceDiagram
    participant A as 요청 A
    participant DB as PostgreSQL
    participant B as 요청 B

    Note over A,B: 같은 참가자(id=3)에 동시 승인 요청

    A->>DB: SELECT ... WHERE id=3 FOR UPDATE
    activate DB
    DB-->>A: 잠금 획득 + 상태: SUBMITTED

    B->>DB: SELECT ... WHERE id=3 FOR UPDATE
    Note right of B: 대기 (잠금 해제까지 블로킹)

    A->>DB: UPDATE status = 'APPROVED'
    A->>DB: COMMIT
    deactivate DB
    Note over DB: 잠금 해제

    activate DB
    DB-->>B: 잠금 획득 + 상태: APPROVED
    deactivate DB

    B--xB: "제출 완료 상태에서만 승인 가능" → 거부
