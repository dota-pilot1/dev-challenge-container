================================================================================
  현재 프로젝트 vs 실무 프로젝트 비교
================================================================================


[결론: 거의 유사하다]

  현재 프로젝트에서 다루는 문제들은 실무에서 실제로 발생하는 문제와 본질적으로 같다.
  규모와 트래픽만 다를 뿐, 문제의 패턴은 동일하다.


================================================================================
[현재 프로젝트가 재현하는 실무 문제]
================================================================================

  현재 프로젝트                          실무 사례
  ─────────────────────────────────    ─────────────────────────────────
  챌린지 승인 → 주문 생성               주문 → 결제 API 호출
  (concurrency-lab → shop-api)         (주문서버 → PG사/결제서버)

  중복 승인 (동시 클릭)                  중복 결제 (더블클릭, 네트워크 재시도)
  → SELECT FOR UPDATE                  → 동일한 해결법 사용

  재고 경합 (동시 주문)                  쿠팡/배민 선착순 쿠폰, 한정판 상품
  → 원자적 UPDATE                       → 동일한 해결법 + Redis 분산락

  주문 실패 시 빈 승인                   결제 실패 시 주문만 남는 문제
  → 상태 분리 (APPROVE_FAILED)          → 주문 상태 분리 (PAYMENT_FAILED)

  응답 유실 (네트워크 불확실성)          PG 응답 유실 → 결제됐는지 모름
  → 멱등키                              → 멱등키 (실무 필수)

  유령 주문 (커밋 실패)                  결제 완료 후 주문 DB 장애
  → Saga / Outbox 패턴                  → 동일한 패턴 사용


================================================================================
[실무에서 추가로 고려하는 것들]
================================================================================

  현재 프로젝트에 없지만 실무에서 필요한 것:

  1. 트래픽 규모
     - 현재: 관리자 몇 명이 동시 클릭
     - 실무: 초당 수천~수만 요청 (선착순 이벤트 등)
     - 추가 필요: Redis 분산락, 메시지 큐(Kafka), 캐싱

  2. 모니터링/알림
     - 현재: 로그만 출력
     - 실무: 정합성 깨지면 즉시 알림 (Slack, PagerDuty)
     - 추가 필요: 정합성 체크 배치, 불일치 자동 감지

  3. 보상 처리 자동화
     - 현재: 수동 확인 필요 (order_id = NULL 찾아서 처리)
     - 실무: 스케줄러가 자동 재시도 또는 자동 취소
     - 추가 필요: 재시도 큐, Dead Letter Queue

  4. 멀티 인스턴스
     - 현재: 서버 1대씩
     - 실무: 같은 서버가 여러 대 (로드밸런싱)
     - 추가 필요: DB 락만으로 부족할 수 있음 → Redis 분산락

  5. 타임아웃/서킷브레이커
     - 현재: 외부 호출 실패 시 catch로 처리
     - 실무: 타임아웃 설정, 서킷브레이커 (Resilience4j 등)
     - 추가 필요: 외부 서비스 장애 시 전체 시스템 보호


================================================================================
[유사도 정리]
================================================================================

  문제 영역           유사도    비고
  ─────────────────  ────────  ──────────────────────────────
  동시성 제어 (락)    ★★★★★   패턴 완전 동일
  분산 트랜잭션       ★★★★★   2서버 구조는 실무 핵심 패턴
  멱등성              ★★★★☆   실무는 더 복잡한 키 전략
  Saga 패턴           ★★★★☆   실무는 서비스 3개 이상도 흔함
  재고/한정 리소스    ★★★★★   선착순 문제 그 자체
  모니터링/운영       ★★☆☆☆   현재 프로젝트에 아직 없음
  트래픽 규모         ★★☆☆☆   실무는 수천 배 이상

  핵심 결론:
  문제의 패턴과 해결 원리는 동일하다.
  규모가 커지면 같은 원리를 더 정교하게 적용할 뿐이다.

================================================================================
