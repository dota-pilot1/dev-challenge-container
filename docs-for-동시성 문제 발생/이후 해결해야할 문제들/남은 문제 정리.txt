================================================================================
  이후 해결해야 할 문제들
================================================================================

  해결 완료:
    ✓ 1. 중복 승인 → SELECT FOR UPDATE
    ✓ 2. 재고 경합 → 원자적 UPDATE

  남은 문제:

================================================================================

[3. 주문 실패 시 빈 승인]

  현재:
    shop-api 주문 실패해도 APPROVED 처리 → order_id = NULL
    승인은 됐는데 보상이 없는 상태

  해결 방향:
    - APPROVE_FAILED 상태 도입 (실패를 명시적으로 구분)
    - 또는 Saga 패턴: 주문 실패 시 승인 자체를 롤백

================================================================================

[4. 네트워크 응답 유실]

  현재:
    shop-api가 주문 생성했지만 응답이 유실되면
    concurrency-lab은 실패로 판단 → order_id = NULL
    재시도하면 주문이 또 생김

  해결 방향:
    - 멱등키(Idempotency Key): participationId를 주문 요청에 포함
    - 같은 키로 재요청 시 기존 주문 반환 (중복 생성 방지)

================================================================================

[5. 주문 성공 후 커밋 실패 (유령 주문)]

  현재:
    shop-api 주문 완료 → 로컬 DB 커밋 실패 → 롤백
    shop-api에는 주문 존재, concurrency-lab에는 기록 없음

  해결 방향:
    - Saga 패턴: 커밋 실패 시 shop-api 주문 취소 API 호출
    - 또는 Outbox 패턴: 이벤트 기반 비동기 처리

================================================================================

[6. 동시성 테스트 UI]

  현재:
    /concurrency-test 페이지 플레이스홀더만 존재

  구현 필요:
    - 동시 요청 발사 (N건 동시 승인, N건 동시 주문)
    - 결과 시각화 (성공/실패, 소요시간)
    - 양쪽 DB 정합성 검증

================================================================================

[우선순위]

  3~4번: 상태 분리 + 멱등키로 해결 가능 (중간 난이도)
  5번: Saga/Outbox 패턴 필요 (높은 난이도)
  6번: 위 문제들 재현/검증용 도구

================================================================================
